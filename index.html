<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Spinning Potato</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap');
    :root {
      --bg-light: #fff;
      --bg-dark: #121212;
      --text-light: #000;
      --text-dark: #eee;
      --accent: #BB86FC;
    }
    [data-theme="light"] { background: var(--bg-light); color: var(--text-light); }
    [data-theme="dark"]  { background: var(--bg-dark);  color: var(--text-dark);  }
    html, body {
      margin: 0; padding: 0; width:100%; height:100%;
      overflow: hidden; font-family: 'Roboto', sans-serif;
      display: flex; align-items: center; justify-content: center;
      background-size: cover; background-position: center; background-attachment: fixed;
    }
    #toolbar {
      position: fixed; top: 12px; left: 50%; transform: translateX(-50%);
      display: flex; flex-wrap: wrap; gap: 6px;
      background: rgba(0,0,0,0.5); padding: 8px; border-radius: 8px; z-index: 10;
    }
    #toolbar > * {
      font-size:12px; padding:6px 8px;
      background: var(--accent); color: #fff; border: none; border-radius:4px;
      cursor: pointer;
    }
    #toolbar label { display: flex; align-items: center; }
    #toolbar input[type=file] { padding: 3px; }
    #toolbar input[type=range] {
      width: 100px; appearance: none; height: 4px; border-radius:2px;
      background: #ccc; cursor: pointer;
    }
    #toolbar input[type=range]::-webkit-slider-thumb {
      appearance: none; width: 12px; height: 12px; border-radius:50%;
      background: var(--accent);
      margin-top: -4px;
    }
    #container {
      position: relative; width:300px; height:300px; overflow: visible; z-index:5;
      display:flex; align-items:center; justify-content:center;
    }
    #potato {
      font-size:250px; animation: spin linear infinite var(--spin-speed,3s);
    }
    @keyframes spin {
      from{ transform: rotate(0deg); }
      to  { transform: rotate(360deg); }
    }
    .flip-clock {
      position: absolute; top: 8px; display: none; flex-direction: row; gap:4px; z-index:8;
    }
    .digit {
      width:40px; height:50px; perspective: 400px; position: relative;
    }
    .card {
      position:absolute; width:100%; height:50%; overflow:hidden; backface-visibility:hidden;
    }
    .card.top { top:0; border-bottom:1px solid #222; }
    .card.bottom { bottom:0; border-top:1px solid #222; }
    .face {
      position:absolute; width:100%; height:200%;
      background: #000; color: #0ff;
      display:flex; align-items:center; justify-content:center;
      font-family: 'Courier New', monospace; font-size:28px;
    }
    .card.top .face { transform-origin: bottom; }
    .card.bottom .face { transform-origin: top; top:-50%; }
    .card.top.flip .face { animation: flipTop .4s ease-in forwards; }
    .card.bottom.flip .face { animation: flipBottom .4s ease-out forwards; }
    @keyframes flipTop { from{transform:rotateX(0)} to{transform:rotateX(-90deg);} }
    @keyframes flipBottom{ from{transform:rotateX(90deg);} to{transform:rotateX(0);} }
    #dvdLogo {
      position: fixed; width:60px; height:60px; display: none; z-index: 6;
    }
    canvas {
      position: fixed; top:0; left:0; width:100%; height:100%; pointer-events:none; z-index:1;
    }
    #exitBtn {
      position: fixed; top:12px; right:12px;
      width:32px; height:32px; font-size:20px;
      background: var(--accent); color:#fff; border:none; border-radius:50%;
      display:none; align-items:center; justify-content:center; cursor:pointer; z-index:10;
    }
    :fullscreen #toolbar,
    :fullscreen #exitBtn.hidden {
      display:none;
    }
  </style>
</head>
<body data-theme="dark">
  <canvas id="particleCanvas"></canvas>
  <div id="toolbar">
    <button id="themeBtn">Theme</button>
    <button id="fsBtn">Fullscreen</button>
    <label>BG<input type="file" id="bgInput" accept="image/*"></label>
    <button id="removeBgBtn">Remove BG</button>
    <button id="toggleClockBtn">Clock</button>
    <label>DVD<input type="file" id="dvdInput" accept="image/*"></label>
    <button id="toggleDvdBtn">DVD</button>
    <label>Speed<input type="range" id="speedSlider" min="0.5" max="10" step="0.1" value="3"></label>
    <button id="toggleParticlesBtn">Particles On</button>
  </div>

  <div id="container">
    <span id="potato">ðŸ¥”</span>
    <div class="flip-clock" id="flipClock">
      <div class="digit"></div><div class="digit"></div>
      <div class="digit"></div><div class="digit"></div>
    </div>
  </div>

  <img id="dvdLogo" src="https://upload.wikimedia.org/wikipedia/commons/3/3c/DVD_logo.svg" alt="DVD" />
  <button id="exitBtn">âœ•</button>

  <script>
    // Particle rain
    const canvas = document.getElementById('particleCanvas'),
          ctx    = canvas.getContext('2d');
    let particles = [], particlesOn = true;
    function resize() { canvas.width = innerWidth; canvas.height = innerHeight; }
    window.addEventListener('resize', resize); resize();
    function initParticles(){
      particles = Array.from({length:150}, ()=>({
        x: Math.random()*canvas.width,
        y: Math.random()*canvas.height,
        r: Math.random()*3+2,
        s: Math.random()+0.5
      }));
    }
    function draw(){
      ctx.clearRect(0,0,canvas.width,canvas.height);
      if(particlesOn){
        ctx.fillStyle = document.body.dataset.theme==='dark'
          ? 'rgba(255,255,255,0.5)'
          : 'rgba(0,0,0,0.5)';
        particles.forEach(p=>{
          ctx.beginPath();
          ctx.arc(p.x,p.y,p.r,0,2*Math.PI);
          ctx.fill();
          p.y += p.s;
          if(p.y>canvas.height) p.y=0;
        });
      }
      requestAnimationFrame(draw);
    }
    initParticles(); draw();

    // Elements
    const body       = document.body,
          themeBtn   = document.getElementById('themeBtn'),
          fsBtn      = document.getElementById('fsBtn'),
          bgInput    = document.getElementById('bgInput'),
          removeBg   = document.getElementById('removeBgBtn'),
          clockBtn   = document.getElementById('toggleClockBtn'),
          dvdInput   = document.getElementById('dvdInput'),
          dvdBtn     = document.getElementById('toggleDvdBtn'),
          speedSlider= document.getElementById('speedSlider'),
          particlesBtn = document.getElementById('toggleParticlesBtn'),
          potato     = document.getElementById('potato'),
          flipClock  = document.getElementById('flipClock'),
          digits     = flipClock.querySelectorAll('.digit'),
          dvdLogo    = document.getElementById('dvdLogo'),
          exitBtn    = document.getElementById('exitBtn');

    // Rotation speed
    const minV = +speedSlider.min, maxV = +speedSlider.max;
    speedSlider.oninput = ()=>{
      const v = +speedSlider.value,
            inv = (maxV + minV) - v;
      potato.style.setProperty('--spin-speed', inv + 's');
      const perc = (v-minV)/(maxV-minV)*100;
      speedSlider.style.background = `linear-gradient(to right, var(--accent) 0%, var(--accent) ${perc}%, #ccc ${perc}%, #ccc)`;
    };
    speedSlider.oninput();

    // Theme toggle
    themeBtn.onclick = ()=> body.dataset.theme = body.dataset.theme==='dark' ? 'light' : 'dark';

    // Fullscreen
    fsBtn.onclick = ()=> document.documentElement.requestFullscreen();

    // Background upload/remove
    bgInput.onchange = e=>{
      const f= e.target.files[0];
      if(f) body.style.backgroundImage = `url('${URL.createObjectURL(f)}')`;
    };
    removeBg.onclick = ()=>{ body.style.backgroundImage=''; bgInput.value=''; };

    // Flip clock creation
    digits.forEach(d=>{
      d.innerHTML = `
        <div class="card top"><div class="face"></div></div>
        <div class="card bottom"><div class="face"></div></div>`;
    });
    let lastTime = '';
    function updateClock(){
      const now = new Date(),
            h = String(now.getHours()).padStart(2,'0'),
            m = String(now.getMinutes()).padStart(2,'0'),
            s = String(now.getSeconds()).padStart(2,'0'),
            str = h+m+s;
      digits.forEach((d,i)=>{
        const newD = str[i], oldD = lastTime[i] || newD;
        if(newD !== oldD){
          const topFace = d.querySelector('.card.top .face'),
                botFace = d.querySelector('.card.bottom .face');
          topFace.textContent = oldD;
          botFace.textContent = newD;
          d.querySelector('.card.top').classList.add('flip');
          setTimeout(()=>{
            d.querySelector('.card.top').classList.remove('flip');
            d.querySelector('.card.bottom').classList.add('flip');
          }, 200);
          setTimeout(()=>{
            d.querySelector('.card.bottom').classList.remove('flip');
          }, 400);
        }
      });
      lastTime = str;
    }
    let clockInterval = null;
    clockBtn.onclick = ()=>{
      if(flipClock.style.display !== 'flex'){
        flipClock.style.display = 'flex';
        updateClock();
        clockInterval = setInterval(updateClock, 1000);
      } else {
        clearInterval(clockInterval);
        flipClock.style.display = 'none';
      }
    };

    // DVD logo bounce
    dvdInput.onchange = e=>{
      const f = e.target.files[0];
      dvdLogo.src = f
        ? URL.createObjectURL(f)
        : 'https://upload.wikimedia.org/wikipedia/commons/3/3c/DVD_logo.svg';
    };
    let dvdInterval = null;
    let dvdState = { x:0, y:0, vx:3, vy:3, hue:0 };
    dvdBtn.onclick = ()=>{
      if(dvdLogo.style.display !== 'block'){
        dvdState = { x:0, y:0, vx:3, vy:3, hue:0 };
        dvdLogo.style.display = 'block';
        dvdInterval = setInterval(()=>{
          const w = window.innerWidth, h = window.innerHeight;
          dvdState.x += dvdState.vx;
          dvdState.y += dvdState.vy;
          if(dvdState.x < 0 || dvdState.x + dvdLogo.width > w){
            dvdState.vx *= -1;
            dvdState.hue = (dvdState.hue + 90) % 360;
          }
          if(dvdState.y < 0 || dvdState.y + dvdLogo.height > h){
            dvdState.vy *= -1;
            dvdState.hue = (dvdState.hue + 90) % 360;
          }
          dvdLogo.style.left = dvdState.x + 'px';
          dvdLogo.style.top  = dvdState.y + 'px';
          dvdLogo.style.filter = `hue-rotate(${dvdState.hue}deg)`;
        }, 16);
      } else {
        clearInterval(dvdInterval);
        dvdLogo.style.display = 'none';
      }
    };

    // Particles toggle
    particlesBtn.onclick = ()=>{
      particlesOn = !particlesOn;
      particlesBtn.textContent = particlesOn ? 'Particles On' : 'Particles Off';
    };

    // Exit fullscreen
    document.addEventListener('fullscreenchange', ()=>{
      if(!document.fullscreenElement){
        clearInterval(clockInterval);
        clearInterval(dvdInterval);
        flipClock.style.display = 'none';
        dvdLogo.style.display = 'none';
        exitBtn.style.display = 'none';
      }
    });
    document.addEventListener('click', ()=>{
      if(document.fullscreenElement){
        exitBtn.style.display = 'flex';
        clearTimeout(exitBtn._timeout);
        exitBtn._timeout = setTimeout(()=>{
          exitBtn.style.display = 'none';
        }, 3000);
      }
    });
    exitBtn.onclick = ()=> document.exitFullscreen();
  </script>
</body>
</html>
